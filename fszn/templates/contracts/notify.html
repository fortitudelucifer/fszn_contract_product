{% extends 'base.html' %}

{% block content %}
<h2>发送通知：{{ contract.project_code }} - {{ contract.name }}</h2>

<p>客户公司：{{ contract.company.name if contract.company else '' }}</p>

<form method="post" action="{{ url_for('contracts.notify_contract', contract_id=contract.id) }}">
    <div style="margin-bottom: 8px;">
        <label>通知通道：</label>
        <select name="channel">
            <option value="email" {% if default_channel == 'email' %}selected{% endif %}>邮件</option>
            <option value="sms" {% if default_channel == 'sms' %}selected{% endif %}>短信</option>
            <option value="wechat" {% if default_channel == 'wechat' %}selected{% endif %}>微信/企业微信</option>
        </select>
    </div>

    <div style="margin-bottom: 8px;">
        <label>接收人（邮箱 / 手机 / 微信ID）：</label><br>
        <input type="text" name="target" value="{{ default_target or '' }}" style="width: 100%;">
    </div>

    <div style="margin-bottom: 8px;">
        <label>模板编码：</label><br>
        <input type="text" name="template_code"
               value="{{ default_template_code or 'CONTRACT_EVENT' }}" style="width: 100%;">
        <div style="font-size: 12px; color: #666;">
            可约定一些常用编码，例如：<br>
            CONTRACT_DELAY（项目延期提醒）、CONTRACT_ACCEPTANCE（验收提醒）等。
        </div>
    </div>

    <div style="margin-bottom: 8px;">
        <label>通知内容：</label><br>
        <textarea name="message" rows="4" style="width: 100%;">{{ default_message or '' }}</textarea>
    </div>

    <div style="margin-top: 12px;">
        <button type="submit">发送</button>
        <a href="{{ url_for('contracts.list_contracts') }}" style="margin-left: 8px;">返回列表</a>
    </div>
</form>
{% endblock %}
